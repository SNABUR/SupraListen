[rpcClient] DEBUG: Fetched 0 events in total from https://rpc-mainnet.supra.com/rpc/v1 for blocks 20770452-20770454
[rpcClient] DEBUG: Fetching latest block height from https://rpc-mainnet.supra.com/rpc/v1/block
[rpcClient] DEBUG: Latest block height from https://rpc-testnet.supra.com/rpc/v1: 29583918
[poller] INFO: [supra-testnet] Updated latest block height from 29583911 to 29583918
[poller] INFO: [supra-testnet] Processing blocks 29568419 to 29568428 (Latest: 29583918)
[rpcClient] DEBUG: Latest block height from https://rpc-mainnet.supra.com/rpc/v1: 20770458
[poller] INFO: [supra-mainnet] Updated latest block height from 20770453 to 20770458
[poller] INFO: [supra-mainnet] Processing blocks 20770454 to 20770458 (Latest: 20770458)
[scheduled-tasks] INFO: Triggering OHLC Processing for supra-testnet (cron: * * * * *)
Error in hasSignal for network supra-testnet: SqliteError: no such column: network
    at SignalDB.hasSignal (lib\signalDB.ts:53:33)
    at executeProcessOHLC (lib\tasks\executeProcessOHLC.ts:42:18)
    at node_cron__WEBPACK_IMPORTED_MODULE_1___default.schedule.timezone (lib\TaskProcessor.ts:108:33)
  51 |         if (!network) return false;
  52 |         try {
> 53 |             const stmt = this.db.prepare('SELECT 1 FROM activity_signals WHERE network = ? LIMIT 1');
     |                                 ^
  54 |             const result = stmt.get(network);
  55 |             return !!result;
  56 |         } catch (error) { {
  code: 'SQLITE_ERROR'
}
[scheduled-tasks] INFO: Triggering OHLC Processing for supra-mainnet (cron: * * * * *)
Error in hasSignal for network supra-mainnet: SqliteError: no such column: network
    at SignalDB.hasSignal (lib\signalDB.ts:53:33)
    at executeProcessOHLC (lib\tasks\executeProcessOHLC.ts:42:18)
    at node_cron__WEBPACK_IMPORTED_MODULE_1___default.schedule.timezone (lib\TaskProcessor.ts:108:33)
  51 |         if (!network) return false;
  52 |         try {
> 53 |             const stmt = this.db.prepare('SELECT 1 FROM activity_signals WHERE network = ? LIMIT 1');
     |                                 ^
  54 |             const result = stmt.get(network);
  55 |             return !!result;
  56 |         } catch (error) { {
  code: 'SQLITE_ERROR'
}
[rpcClient] DEBUG: Fetched 0 events in total from https://rpc-mainnet.supra.com/rpc/v1 for blocks 20770454-20770459
[rpcClient] DEBUG: Fetching latest block height from https://rpc-mainnet.supra.com/rpc/v1/block
[rpcClient] DEBUG: Fetched 0 events in total from https://rpc-testnet.supra.com/rpc/v1 for blocks 29568419-29568429
[rpcClient] DEBUG: Fetching latest block height from https://rpc-testnet.supra.com/rpc/v1/block
[rpcClient] DEBUG: Latest block height from https://rpc-mainnet.supra.com/rpc/v1: 20770459
[poller] INFO: [supra-mainnet] Updated latest block height from 20770458 to 20770459
[poller] INFO: [supra-mainnet] Processing blocks 20770459 to 20770459 (Latest: 20770459)
[rpcClient] DEBUG: Latest block height from https://rpc-testnet.supra.com/rpc/v1: 29583922
[poller] INFO: [supra-testnet] Updated latest block height from 29583918 to 29583922
[poller] INFO: [supra-testnet] Processing blocks 29568429 to 29568438 (Latest: 29583922)
[rpcClient] DEBUG: Fetched 0 events in total from https://rpc-testnet.supra.com/rpc/v1 for blocks 29568429-29568439
[rpcClient] DEBUG: Fetching latest block height from https://rpc-testnet.supra.com/rpc/v1/block
[rpcClient] DEBUG: Latest block height from https://rpc-testnet.supra.com/rpc/v1: 29583926
[poller] INFO: [supra-testnet] Updated latest block height from 29583922 to 29583926
[poller] INFO: [supra-testnet] Processing blocks 29568439 to 29568448 (Latest: 29583926)
[rpcClient] DEBUG: Fetched 0 events in total from https://rpc-mainnet.supra.com/rpc/v1 for blocks 20770459-20770460
[rpcClient] DEBUG: Fetching latest block height from https://rpc-mainnet.supra.com/rpc/v1/block
[rpcClient] DEBUG: Fetched 0 events in total from https://rpc-testnet.supra.com/rpc/v1 for blocks 29568439-29568449
[rpcClient] DEBUG: Fetching latest block height from https://rpc-testnet.supra.com/rpc/v1/block
[rpcClient] DEBUG: Latest block height from https://rpc-mainnet.supra.com/rpc/v1: 20770459
[rpcClient] DEBUG: Latest block height from https://rpc-testnet.supra.com/rpc/v1: 29583931
[poller] INFO: [supra-testnet] Updated latest block height from 29583926 to 29583931
[poller] INFO: [supra-testnet] Processing blocks 29568449 to 29568458 (Latest: 29583931)
[rpcClient] DEBUG: Fetched 0 events in total from https://rpc-testnet.supra.com/rpc/v1 for blocks 29568449-29568459
[rpcClient] DEBUG: Fetching latest block height from https://rpc-testnet.supra.com/rpc/v1/block
[rpcClient] DEBUG: Fetching latest block height from https://rpc-mainnet.supra.com/rpc/v1/block
[rpcClient] DEBUG: Latest block height from https://rpc-mainnet.supra.com/rpc/v1: 20770463
[poller] INFO: [supra-mainnet] Updated latest block height from 20770459 to 20770463
[poller] INFO: [supra-mainnet] Processing blocks 20770460 to 20770463 (Latest: 20770463)
[rpcClient] DEBUG: Latest block height from https://rpc-testnet.supra.com/rpc/v1: 29583936
[poller] INFO: [supra-testnet] Updated latest block height from 29583931 to 29583936
[poller] INFO: [supra-testnet] Processing blocks 29568459 to 29568468 (Latest: 29583936)
[rpcClient] DEBUG: Fetched 1 events in total from https://rpc-mainnet.supra.com/rpc/v1 for blocks 20770460-20770464
[poller] INFO: [supra-mainnet] Fetched 1 events from blocks 20770460-20770463.
[rpcClient] DEBUG: Fetched 0 events in total from https://rpc-testnet.supra.com/rpc/v1 for blocks 29568459-29568469
[rpcClient] DEBUG: Fetching latest block height from https://rpc-testnet.supra.com/rpc/v1/block
prisma:query SELECT 1
prisma:query BEGIN
prisma:query DEALLOCATE ALL
[eventProcessor] DEBUG: Processing 1 RpcEvents in current batch for network supra-mainnet.
prisma:query SELECT 1
prisma:query BEGIN
prisma:query DEALLOCATE ALL
[eventProcessor] DEBUG: Starting transaction for event: Tx:unknown_tx_for_0x2e1e06a4d4d16fb89474347f51370e06318100d01982f57d6d1d7f8293e795b5::spike_fun::TradeEvent_block_20770460 Seq:290 Type:0x2e1e06a4d4d16fb89474347f51370e06318100d01982f57d6d1d7f8293e795b5::spike_fun::TradeEvent Net:supra-mainnet
[rpcClient] DEBUG: Latest block height from https://rpc-testnet.supra.com/rpc/v1: 29583940
[poller] INFO: [supra-testnet] Updated latest block height from 29583936 to 29583940
[poller] INFO: [supra-testnet] Processing blocks 29568469 to 29568478 (Latest: 29583940)
prisma:query INSERT INTO "public"."EventTracking" ("eventType","blockHeight","transactionHash","processed","error","createdAt","updatedAt","network","sequenceNumber") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9) ON CONFLICT ("network","transactionHash","sequenceNumber","eventType") DO UPDATE SET "error" = $10, "processed" = $11 WHERE (("public"."EventTracking"."network" = $12 AND "public"."EventTracking"."transactionHash" = $13 AND "public"."EventTracking"."sequenceNumber" = $14 AND "public"."EventTracking"."eventType" = $15) AND 1=1) RETURNING "public"."EventTracking"."id", "public"."EventTracking"."eventType", "public"."EventTracking"."blockHeight", "public"."EventTracking"."transactionHash", "public"."EventTracking"."processed", "public"."EventTracking"."error", "public"."EventTracking"."createdAt", "public"."EventTracking"."updatedAt", "public"."EventTracking"."network", "public"."EventTracking"."sequenceNumber"
[eventProcessor] INFO: [supra-mainnet] TradeEvent detected. Processing...
[tradeEventHandler] DEBUG: [supra-mainnet] Processing TradeEvent {"creator_fee":"300000","is_buy":true,"platform_fee":"400000","supra_amount":"100000000","timestamp":"1755753845","token_address":"0xa6c2bd70d06129390cd3d60e03baa06db770c5acbc1b3d3229ea4f7493328554","token_amount":"13650384489","user":"0x6e3e09ab7fd0145d7befc0c68d6944ddc1a90fd45b8a6d28c76d8c48bed676b0","virtual_supra_reserves":"1784233844426012","virtual_token_reserves":"243554766297909624"}
prisma:query SELECT "public"."TradeEvent"."id" FROM "public"."TradeEvent" WHERE (("public"."TradeEvent"."network" = $1 AND "public"."TradeEvent"."creationNumber" = $2 AND "public"."TradeEvent"."sequenceNumber" = $3 AND "public"."TradeEvent"."type" = $4) AND 1=1) LIMIT $5 OFFSET $6
[tradeEventHandler] INFO: [supra-mainnet] TradeEvent does not exist. CREATING...
prisma:query INSERT INTO "public"."TradeEvent" ("type","creationNumber","accountAddress","sequenceNumber","timestamp","isBuy","supraAmount","tokenAddress","tokenAmount","user","virtualSupraReserves","virtualTokenReserves","createdAt","updatedAt","network","processedForOHLC") VALUES ($1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14,$15,$16) RETURNING "public"."TradeEvent"."id", "public"."TradeEvent"."type", "public"."TradeEvent"."creationNumber", "public"."TradeEvent"."accountAddress", "public"."TradeEvent"."sequenceNumber", "public"."TradeEvent"."timestamp", "public"."TradeEvent"."isBuy", "public"."TradeEvent"."supraAmount", "public"."TradeEvent"."tokenAddress", "public"."TradeEvent"."tokenAmount", "public"."TradeEvent"."user", "public"."TradeEvent"."virtualSupraReserves", "public"."TradeEvent"."virtualTokenReserves", "public"."TradeEvent"."createdAt", "public"."TradeEvent"."updatedAt", "public"."TradeEvent"."network", "public"."TradeEvent"."processedForOHLC"
[tradeEventHandler] INFO: [supra-mainnet] Successfully created TradeEvent for user 0x6e3e09ab7fd0145d7befc0c68d6944ddc1a90fd45b8a6d28c76d8c48bed676b0
[tradeEventHandler] INFO: [supra-mainnet] Updating token holder balance for user 0x6e3e09ab7fd0145d7befc0c68d6944ddc1a90fd45b8a6d28c76d8c48bed676b0
[rpcClient] DEBUG: Fetched 0 events in total from https://rpc-testnet.supra.com/rpc/v1 for blocks 29568469-29568479
[rpcClient] DEBUG: Fetching latest block height from https://rpc-testnet.supra.com/rpc/v1/block
prisma:query SELECT "public"."users"."network", "public"."users"."walletAddress" FROM "public"."users" WHERE (("public"."users"."network" = $1 AND "public"."users"."walletAddress" = $2) AND 1=1) OFFSET $3
prisma:query SELECT "public"."users"."network", "public"."users"."walletAddress", "public"."users"."username", "public"."users"."avatarUrl", "public"."users"."createdAt", "public"."users"."updatedAt", "public"."users"."nonce" FROM "public"."users" WHERE (("public"."users"."network" = $1 AND "public"."users"."walletAddress" = $2) AND (("public"."users"."network" = $3 AND "public"."users"."walletAddress" = $4) AND 1=1)) LIMIT $5 OFFSET $6
prisma:query SELECT "public"."users"."network", "public"."users"."walletAddress", "public"."users"."username", "public"."users"."avatarUrl", "public"."users"."createdAt", "public"."users"."updatedAt", "public"."users"."nonce" FROM "public"."users" WHERE ("public"."users"."network" = $1 AND "public"."users"."walletAddress" = $2) LIMIT $3 OFFSET $4
[rpcClient] DEBUG: Latest block height from https://rpc-testnet.supra.com/rpc/v1: 29583947
[poller] INFO: [supra-testnet] Updated latest block height from 29583940 to 29583947
[poller] INFO: [supra-testnet] Processing blocks 29568479 to 29568488 (Latest: 29583947)
prisma:query INSERT INTO "public"."token_holders" ("network","userWalletAddress","tokenAddress","balance","createdAt","updatedAt") VALUES ($1,$2,$3,$4,$5,$6) ON CONFLICT ("network","userWalletAddress","tokenAddress") DO UPDATE SET "balance" = ("public"."token_holders"."balance" + $7), "updatedAt" = $8 WHERE (("public"."token_holders"."network" = $9 AND "public"."token_holders"."userWalletAddress" = $10 AND "public"."token_holders"."tokenAddress" = $11) AND 1=1) RETURNING "public"."token_holders"."network", "public"."token_holders"."userWalletAddress", "public"."token_holders"."tokenAddress", "public"."token_holders"."balance", "public"."token_holders"."createdAt", "public"."token_holders"."updatedAt"
[tradeEventHandler] INFO: [supra-mainnet] Successfully updated token holder balance for user 0x6e3e09ab7fd0145d7befc0c68d6944ddc1a90fd45b8a6d28c76d8c48bed676b0
[eventProcessor] INFO: [supra-mainnet] TradeEvent processed. Adding signal...
prisma:query ROLLBACK
[eventProcessor] ERROR: Transaction for event Tx:unknown_tx_for_0x2e1e06a4d4d16fb89474347f51370e06318100d01982f57d6d1d7f8293e795b5::spike_fun::TradeEvent_block_20770460 Seq:290 Type:0x2e1e06a4d4d16fb89474347f51370e06318100d01982f57d6d1d7f8293e795b5::spike_fun::TradeEvent Net:supra-mainnet FAILED and was rolled back. Error: table activity_signals has no column named network
prisma:query BEGIN
prisma:query DEALLOCATE ALL
prisma:query UPDATE "public"."EventTracking" SET "error" = $1, "processed" = $2 WHERE ("public"."EventTracking"."network" = $3 AND "public"."EventTracking"."transactionHash" = $4 AND "public"."EventTracking"."sequenceNumber" = $5 AND "public"."EventTracking"."eventType" = $6)
prisma:query COMMIT
[eventProcessor] WARN: Error for event Tx:unknown_tx_for_0x2e1e06a4d4d16fb89474347f51370e06318100d01982f57d6d1d7f8293e795b5::spike_fun::TradeEvent_block_20770460 Seq:290 Type:0x2e1e06a4d4d16fb89474347f51370e06318100d01982f57d6d1d7f8293e795b5::spike_fun::TradeEvent Net:supra-mainnet has been logged to EventTracking.
[eventProcessor] INFO: Finished processing batch of 1 events for network supra-mainnet.
[rpcClient] DEBUG: Fetched 0 events in total from https://rpc-testnet.supra.com/rpc/v1 for blocks 29568479-29568489
[rpcClient] DEBUG: Fetching latest block height from https://rpc-testnet.supra.com/rpc/v1/block
prisma:query COMMIT
[rpcClient] DEBUG: Fetching latest block height from https://rpc-mainnet.supra.com/rpc/v1/block